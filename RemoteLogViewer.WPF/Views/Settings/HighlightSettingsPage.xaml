<Page
	x:Class="RemoteLogViewer.WPF.Views.Settings.HighlightSettingsPage"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:views="using:RemoteLogViewer.Views.Settings"
	xmlns:model="using:RemoteLogViewer.Stores.Settings.Model"
	xmlns:highlight="using:RemoteLogViewer.Core.ViewModels.Settings.Highlight"
	mc:Ignorable="d">
	<Grid Padding="16" RowSpacing="12" ColumnSpacing="16">
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="260" />
			<ColumnDefinition Width="*" />
		</Grid.ColumnDefinitions>
		<Grid.RowDefinitions>
			<RowDefinition Height="*" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>
		<StackPanel Grid.Column="0" Grid.Row="0" Spacing="8">
			<TextBlock Text="Highlight Settings" FontWeight="SemiBold" FontSize="14" />
			<StackPanel Orientation="Horizontal" Spacing="4">
				<Button Content="Add Setting" Command="{x:Bind ViewModel.AddRuleCommand}"/>
				<Button Content="Remove" Command="{x:Bind ViewModel.RemoveRuleCommand}" CommandParameter="{x:Bind ViewModel.SelectedRule.Value, Mode=TwoWay}"/>
			</StackPanel>
			<ListView ItemsSource="{x:Bind ViewModel.Rules}" SelectedItem="{x:Bind ViewModel.SelectedRule.Value, Mode=TwoWay}">
				<ListView.ItemTemplate>
					<DataTemplate x:DataType="highlight:HighlightRuleViewModel">
						<TextBlock Text="{x:Bind Name.Value, Mode=OneWay}"/>
					</DataTemplate>
				</ListView.ItemTemplate>
			</ListView>
		</StackPanel>
		<Grid Grid.Column="1" Grid.Row="0" RowSpacing="12" Visibility="{x:Bind ViewModel.SelectedRule.Value,Mode=OneWay,Converter={StaticResource NullToVisibilityConverter}}">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="*" />
			</Grid.RowDefinitions>
			<StackPanel Orientation="Horizontal" Spacing="8" Grid.Row="0">
				<TextBlock Text="Setting Name" VerticalAlignment="Center" />
				<TextBox Width="240" Text="{x:Bind ViewModel.SelectedRule.Value.Name.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
			</StackPanel>
			<StackPanel Grid.Row="1" Spacing="8">
				<TextBlock Text="Highlight Conditions" FontWeight="SemiBold" />
				<Button Content="Add Condition" Width="140" Command="{x:Bind ViewModel.SelectedRule.Value.AddConditionCommand,Mode=OneWay}"/>
				<Button Content="Remove Condition" HorizontalAlignment="Left" Command="{x:Bind ViewModel.SelectedRule.Value.RemoveConditionCommand,Mode=OneWay}" CommandParameter="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value,Mode=OneWay}"/>
				<ListBox Height="240" ItemsSource="{x:Bind ViewModel.SelectedRule.Value.Conditions,Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value,Mode=TwoWay}">
					<ListBox.ItemTemplate>
						<DataTemplate x:DataType="highlight:HighlightConditionViewModel">
							<TextBlock Text="{x:Bind Pattern.Value, Mode=OneWay}" />
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>
				<Border BorderBrush="Gray" BorderThickness="1" CornerRadius="4" Padding="8" Margin="0,0,0,8" Visibility="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value,Mode=OneWay,Converter={StaticResource NullToVisibilityConverter}}">
					<StackPanel Spacing="6">
						<StackPanel Orientation="Horizontal" Spacing="8">
							<TextBlock Text="Pattern" Width="60" VerticalAlignment="Center" />
							<TextBox Width="240" Text="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.Pattern.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
						</StackPanel>
						<StackPanel Orientation="Horizontal" Spacing="8">
							<TextBlock Text="Type" Width="60" VerticalAlignment="Center" />
							<ComboBox Width="160" ItemsSource="{x:Bind ViewModel.PatternTypes}" SelectedItem="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.PatternType.Value, Mode=TwoWay}">
								<ComboBox.ItemTemplate>
									<DataTemplate>
										<TextBlock Text="{Binding Converter={StaticResource HighlightPatternTypeToStringConverter}}" />
									</DataTemplate>
								</ComboBox.ItemTemplate>
							</ComboBox>
							<CheckBox Content="Ignore Case" IsChecked="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.IgnoreCase.Value, Mode=TwoWay}"/>
							<CheckBox Content="Only Match" IsChecked="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.HighlightOnlyMatch.Value, Mode=TwoWay}" />
						</StackPanel>
						<StackPanel Orientation="Horizontal" Spacing="8">
							<TextBlock Text="Fore" Width="60" VerticalAlignment="Center" />
							<Button
								Width="80">
								<Button.Content>
									<Grid RowDefinitions="Auto,8">
										<TextBlock>Change</TextBlock>
										<Rectangle
											Grid.Row="1"
											RadiusX="4"
											RadiusY="4"
											HorizontalAlignment="Stretch"
											Visibility="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.IsForeColorSet.Value, Mode=OneWay,Converter={StaticResource BooleanToVisibilityConverter}}">
											<Rectangle.Fill>
												<SolidColorBrush Color="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.ForeColor.Value, Mode=OneWay, Converter={StaticResource ColorModelToColorConverter}}" />
											</Rectangle.Fill>
										</Rectangle>
										<Rectangle
											Grid.Row="1"
											Stroke="Black"
											StrokeThickness="1"
											StrokeDashArray="2,2"
											RadiusX="4"
											RadiusY="4"
											Fill="Transparent"
											HorizontalAlignment="Stretch"
											Visibility="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.IsForeColorSet.Value, Mode=OneWay,Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>
									</Grid>
								</Button.Content>
								<Button.Flyout>
									<Flyout>
										<ColorPicker Color="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.ForeColor.Value, Mode=TwoWay, Converter={StaticResource ColorModelToColorConverter}}" IsAlphaEnabled="False" />
									</Flyout>
								</Button.Flyout>
							</Button>
							<Button Command="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.ClearForeColorCommand, Mode=OneWay}">
								<FontIcon FontFamily="Segoe MDL2 Assets" FontSize="20" Margin="0,2,0,0" Glyph="&#xE8E6;" />
							</Button>
							<TextBlock Text="Back" Width="60" VerticalAlignment="Center" />
							<Button
								Width="80">
								<Button.Content>
									<Grid RowDefinitions="Auto,8">
										<TextBlock>Change</TextBlock>
										<Rectangle
											Grid.Row="1"
											RadiusX="4"
											RadiusY="4"
											HorizontalAlignment="Stretch"
											Visibility="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.IsBackColorSet.Value, Mode=OneWay,Converter={StaticResource BooleanToVisibilityConverter}}">
											<Rectangle.Fill>
												<SolidColorBrush Color="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.BackColor.Value, Mode=OneWay, Converter={StaticResource ColorModelToColorConverter}}" />
											</Rectangle.Fill>
										</Rectangle>
										<Rectangle
											Grid.Row="1"
											Stroke="Black"
											StrokeThickness="1"
											StrokeDashArray="2,2"
											RadiusX="4"
											RadiusY="4"
											Fill="Transparent"
											HorizontalAlignment="Stretch"
											Visibility="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.IsBackColorSet.Value, Mode=OneWay,Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>
									</Grid>
								</Button.Content>
								<Button.Flyout>
									<Flyout>
										<ColorPicker Color="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.BackColor.Value, Mode=TwoWay, Converter={StaticResource ColorModelToColorConverter}}" IsAlphaEnabled="True" />
									</Flyout>
								</Button.Flyout>
							</Button>
							<Button Command="{x:Bind ViewModel.SelectedRule.Value.SelectedCondition.Value.ClearBackColorCommand, Mode=OneWay}">
								<FontIcon FontFamily="Segoe MDL2 Assets" FontSize="20" Margin="0,2,0,0" Glyph="&#xE8E6;" />
							</Button>
						</StackPanel>
					</StackPanel>
				</Border>
			</StackPanel>
		</Grid>
	</Grid>
</Page>